@using AppApi.Features.DTOs
@model RegisterDto
<link rel="stylesheet" href="~/css/register.css" />
<div class="modal fade" id="registerModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body" id="loginModalBody">
                <div class="login-container">
                    <div class="login-card">
                        <div class="login-header">
                            <div class="logo-container">
                                <i class="fas fa-tshirt"></i>
                            </div>
                            <h1 class="login-title">Đăng ký</h1>
                            <p class="login-subtitle">Tham gia cộng đồng yêu áo dài truyền thống</p>
                        </div>
                        <div class="login-form">
                            <form asp-area="Auth" asp-controller="Auth" asp-action="Register" method="post" id="loginForm">
                                <div asp-validation-summary="All" class="validation-summary text-danger"></div>
                                <div class="form-floating">
                                    <input asp-for="FullName" type="text" id="fullname" placeholder="Họ và tên" class="form-control" />
                                    <label for="text">
                                        <i class="fas fa-envelope me-2"></i>Họ và tên
                                    </label>
                                    <span asp-validation-for="FullName" class="field-validation-error"></span>
                                </div>
                                <div class="form-floating">
                                    <input asp-for="Email" type="email" id="email" placeholder=" " class="form-control" />
                                    <label for="email">
                                        <i class="fas fa-envelope me-2"></i>Địa chỉ email
                                    </label>
                                    <span asp-validation-for="Email" class="field-validation-error"></span>
                                </div>
                                <div class="form-floating">
                                    <input asp-for="PhoneNumber" type="number" id="phonenumber" placeholder=" " class="form-control" />
                                    <label for="number">
                                        <i class="fas fa-envelope me-2"></i>Số điện thoại
                                    </label>
                                    <span asp-validation-for="Email" class="field-validation-error"></span>
                                </div>
                                <div class="form-floating">
                                    <input asp-for="Address" type="text" id="address" placeholder=" " class="form-control" />
                                    <label for="text">
                                        <i class="fas fa-envelope me-2"></i>Địa chỉ
                                    </label>
                                    <span asp-validation-for="Email" class="field-validation-error"></span>
                                </div>
                                <div class="form-floating">
                                    <input asp-for="Password" type="password" id="password" placeholder=" " class="form-control" />
                                    <label for="password">
                                        <i class="fas fa-lock me-2"></i>Mật khẩu
                                    </label>
                                    <span class="password-toggle" onclick="togglePassword()">
                                        <i class="fas fa-eye" id="passwordToggleIcon"></i>
                                    </span>
                                    <span asp-validation-for="Password" class="field-validation-error"></span>
                                </div>
                                <div class="form-floating">
                                    <input asp-for="ConfirmPassword" type="password" id="confirmPassword" placeholder=" " class="form-control" />
                                    <label for="confirmPassword">
                                        <i class="fas fa-lock me-2"></i>Xác nhận mật khẩu
                                    </label>
                                    <span asp-validation-for="ConfirmPassword" class="field-validation-error"></span>
                                </div>
                                <button type="submit" class="btn btn-login" onclick="submitRegistration(event)" id="registerBtn">
                                    <i class="fas fa-sign-in-alt me-2"></i>
                                    Đăng kí
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function onRegisterSuccess() {
        $('#registerModal').modal('hide');
        $('#successModal').modal('show');
    }
    $(document).ready(function () {
        $('#registerModal').on('shown.bs.modal', function () {
            $(this).find('input:first').focus();
        });
    });
    document.addEventListener('DOMContentLoaded', function() {
        // Form enhancement
        const inputs = document.querySelectorAll('.form-control');

        inputs.forEach(input => {
            input.addEventListener('focus', function() {
                this.parentElement.classList.add('focused');
            });

            input.addEventListener('blur', function() {
                if (!this.value) {
                    this.parentElement.classList.remove('focused');
                }
            });

            if (input.value) {
                input.parentElement.classList.add('focused');
            }
        });

        // Phone number formatting for Vietnam
        const phoneInput = document.querySelector('input[name="PhoneNumber"]');
        if (phoneInput) {
            phoneInput.addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                if (value.length > 0 && !value.startsWith('0') && !value.startsWith('84')) {
                    value = '0' + value;
                }
                e.target.value = value;
            });
        }

        // Password confirmation validation
        const passwordInput = document.querySelector('input[name="Password"]');
        const confirmPasswordInput = document.querySelector('input[name="ConfirmPassword"]');

        if (confirmPasswordInput && passwordInput) {
            confirmPasswordInput.addEventListener('input', function() {
                const password = passwordInput.value;
                const confirmPassword = this.value;
                const errorSpan = this.nextElementSibling;

                if (confirmPassword && password !== confirmPassword) {
                    errorSpan.textContent = 'Mật khẩu xác nhận không khớp';
                    errorSpan.style.display = 'block';
                } else {
                    errorSpan.textContent = '';
                    errorSpan.style.display = 'none';
                }
            });
        }

        // Form submission enhancement
        const form = document.querySelector('form');
        const submitButton = form.querySelector('.btn-register');

        form.addEventListener('submit', function() {
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang xử lý...';
            submitButton.disabled = true;
        });
    });
</script>
